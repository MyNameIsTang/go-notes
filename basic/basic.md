## 文件名、关键字与标识符

1. Go 的源文件以 .go 为后缀名存储在计算机中，且均由小写字母组成。如果文件名由多个部分组成，则使用下划线\_对它们进行分割。
2. Go 语言是区分大小写的。有效的标识符必现以字母（可以使用任何 UTF-8 编码的字符或\_）开头，然后紧跟着 0 个或多个字符或 Unicode 数字。
3. \_ 本身是一个特殊的标识符（空白标识符）。可以像其他标识符那样用于变量的声明或赋值（任何类型），但任何赋给这个标识符的值都将被抛弃，因此这些值不能在后续的代码中使用，也不能使用这个标识符作为变量对其他变量进行赋值或运算。
4. 25 个关键字或保留字，关键字不能作为标识符使用

   | -        | -           | -      | -         | -      |
   | -------- | ----------- | ------ | --------- | ------ |
   | break    | default     | func   | interface | select |
   | case     | defer       | go     | map       | struct |
   | chan     | else        | goto   | package   | switch |
   | const    | fallthrough | if     | range     | type   |
   | continue | for         | import | return    | var    |

5. 36 个预定义标识符

   | -      | -       | -       | -       | -      | -       | -         | -          | -      |
   | ------ | ------- | ------- | ------- | ------ | ------- | --------- | ---------- | ------ |
   | append | bool    | byte    | cap     | close  | complex | complex64 | complex128 | uint16 |
   | copy   | false   | float32 | float64 | image  | int     | int8      | int16      | uint32 |
   | int32  | int64   | iota    | len     | make   | new     | nil       | panic      | uint64 |
   | print  | println | real    | recover | string | true    | uint      | uint8      | uinptr |

6. 程序一般由关键字、常量、变量、运算符、类型和函数组成。还可能使用分隔符：括号()，中括号[]和大括号{}。还会使用标点符号：.、,、;、:和...
7. 代码通过语句来实现结构化。每个语句不需要使用;结尾，这些工作都将由 Go 编译器自动完成。如果将多个语句写在同一行，则必须使用;人为区分（不推荐）。

## Go 程序的基本结构和要素

1.  包的概念、导入与可见性

    - 包是结构化代码的一种方式：每个程序都由包（通常简称为 pkg）的概念组成
    - 每个 Go 文件都属于且仅属于一个包。一个包可以由许多以 .go 为扩展名的源文件组成，因此文件名和包名一般来说都是不相同的。所有的包名都应该使用小写字母。
    - 必须在源文件中非注释的第一行指明这个文件属于哪个包，如：package main。package main 表示一个可独立执行的程序，每个 Go 应用程序都包含一个名为 main 的包。

    1.  标准库

        - Go 的安装文件里包含了一些可以直接使用的包，即标准库。
        - 在 Windows 下，标准库的位置在 Go 根目录下的子目录 pkg\windows*386 中；在 Linux 下，标准库在 Go 根目录下的子目录 pkg\linux_amd64 中（如果是安装的是 32 位，则在 linux_386 目录中）。一般情况下，标准包会存放在 $GOROOT/pkg/$GOOS*$GOARCH/ 目录下。
        - 想要构建一个程序，则包和包内的文件都必须以正确的顺序进行编译。包的依赖关系决定了其构建顺序。
        - 属于同一个包的源文件必须全部被一起编译，一个包即是编译时的一个单元。因此根据惯例，每个目录都只包含一个包。

    2.  对一个包进行更改或重新编译，所有引用了这个包的客户端程序都必须全部重新编译

        - Go 中的包模型 采用了显式依赖关系的机制来达到快速编译的目的，编译器会从后缀名为 .o 的对象文件（需要且只需要这个文件）中提取传递依赖类型的信息。

    3.  每一段代码只会被编译一次

        - 一个 Go 程序是通过 import 关键字将一组包链接在一起，包名被封闭在半角双引号 "" 中。
        - 如果需要多个包，他们可以被分别导入

          ```
            import "fmt"
            import "os"
            <!-- 或者 -->
            import (
              "fmt"
              "os"
            )
          ```

        - 导入多个包时，最好按照字母顺序排列包名，这样做更加清晰易读。
        - 如果包名不是以 . 或 / 开头，如 "fmt" 或者 "container/list"，则 Go 会在全局文件进行查找；如果包名以 ./ 开头，则 Go 会在相对目录中查找；如果包名以 / 开头（在 Windows 下也可以这样使用），则会在系统的绝对路径中查找。
        - 导入包即等同于包含了这个包的所有的代码对象。
        - 除了符号 \_，包中所有代码对象的标识符必须是唯一的，以避免名称冲突。但是相同的标识符可以在不同的包中使用，因为可以使用包名来区分它们。
        - 包通过下面这个被编译器强制执行的规则（可见性规则）来决定是否将自身的代码对象暴露给外部文件：
          - 当标识符（包括常量、变量、类型、函数名、结构字段等等）以一个大写字母开头，那么使用这种形式的标识符的对象就可以被外部包的代码所使用（客户端程序需要先导入这个包），这被称为导出（像面向对象语言中的 public）。大写字母可以使用任何 Unicode 编码的字符，比如希腊文，不仅仅是 ASCII 码中的大写字母。
          - 标识符如果以小写字母开头，则对包外是不可见的，但是它们在整个包的内部是可见并且可用的（像面向对象语言中的 private ）。
          - 包也可以作为命名空间使用，帮助避免命名冲突（名称冲突）。
          - 通过使用包的别名来解决包名之间的名称冲突，如：`import fm "fmt"`。

    4.  注意事项：如果你导入了一个包却没有使用它，则会在构建程序时引发错误
    5.  包的分级声明和初始化

        - 使用 import 导入包之后定义或声明 0 个或多个常量 (const)、变量 (var) 和类型 (type)，这些对象的作用域都是全局的（在本包范围内）。

2.  函数

    - 定义一个函数最简单的格式：`func functionName()`。
      - 可以在括号 () 中写入 0 个或多个函数的参数（使用逗号 , 分隔），每个参数的名称后面必须紧跟着该参数的类型。
      - main() 函数是每一个可执行程序所必须包含的。在程序开始执行并完成初始化后，第一个调用（程序的入口点）的函数是 main.main()（如果有 init() 函数则会先执行该函数），该函数一旦返回就表示程序已成功执行并立即退出。
    - 函数里的代码（函数体）使用大括号 {} 括起来。左大括号 { 必须与方法的声明放在同一行，这是编译器的强制规定（这是因为编译器会产生 func main() ; 这样的结果，很明显这是错误的）。右大括号 } 需要被放在紧接着函数体的下一行。
    - Go 语言虽然看起来不使用分号作为语句的结束，但实际上这一过程是由编译器自动完成，因此才会引发像上面这样的错误。
    - 对于大括号 {} 的使用规则在任何时候都是相同的（如：if 语句等）。
    - 因此符合规范的函数一般写成如下的形式：
      ```
        func functionName(parameter_list) (return_value_list) {
          …
        }
      ```
      - 其中：parameter_list 的形式为 (param1 type1, param2 type2, …)，return_value_list 的形式为 (ret1 type1, ret2 type2, …)。
    - 当某个函数需要被外部包调用的时候才使用大写字母开头，并遵循 Pascal 命名法；否则就遵循骆驼命名法，即第一个单词的首字母小写，其余单词的首字母大写。
    - 程序正常退出的代码为 0 即 Program exited with code 0；如果程序因为异常而被终止，则会返回非零值，如：1。这个数值可以用来测试是否成功执行一个程序。

3.  注释

    - 注释不会被编译，但可以通过 godoc 来使用
    - 单行注释是最常见的注释形式，你可以在任何地方使用以 // 开头的单行注释。
    - 多行注释也叫块注释，均已以 /_ 开头，并以 _/ 结尾，且不可以嵌套使用，多行注释一般用于包的文档描述或注释成块的代码片段。
    - 每一个包应该有相关注释，在 package 语句之前的块注释将被默认认为是这个包的文档说明，其中应该提供一些相关信息并对整体功能做简要的介绍。
    - 几乎所有全局作用域的类型、常量、变量、函数和被导出的对象都应该有一个合理的注释。如果这种注释（称为文档注释）出现在函数前面，例如函数 Abcd，则要以 "Abcd..." 作为开头。

4.  类型

    - 变量（或常量）包含数据，这些数据可以有不同的数据类型，简称类型。
    - 使用 var 声明的变量的值会自动初始化为该类型的零值。类型定义了某个变量的值的集合与可对其进行操作的集合。
    - 类型可以是基本类型，如：int、float、bool、string；结构化的（复合的），如：struct、array、切片 (slice)、map、通道 (channel)；只描述类型的行为的，如：interface。
    - 结构化的类型没有真正的值，它使用 nil 作为默认值。值得注意的是，Go 语言中不存在类型继承。
    - 函数也可以是一个确定的类型，就是以函数作为返回类型。例：`func FunctionName (a typea, b typeb) typeFunc`。
    - 一个函数可以拥有多返回值，返回类型之间需要使用逗号分割，并使用小括号 () 将它们括起来，如：`func FunctionName (a typea, b typeb) (t1 type1, t2 type2)`。这种多返回值一般用于判断某个函数是否执行成功 (true/false) 或与其它返回值一同返回错误消息。
    - 使用 type 关键字可以定义你自己的类型：`type IZ int`
      - 这里并不是真正意义上的别名，因为使用这种方法定义之后的类型可以拥有更多的特性，且在类型转换时必须显式转换。
      - 如果你有多个类型需要定义，可以使用因式分解关键字的方式：
        ```
          type (
            IZ int
            FZ float64
            STR string
          )
        ```
    - 每个值都必须在经过编译后属于某个类型（编译器必须能够推断出所有值的类型），因为 Go 语言是一种静态类型语言。

5.  Go 程序的一般结构

    1. Go 程序的首选结构，总体思路如下：

       - 在完成包的 import 之后，开始对常量、变量和类型的定义或声明。
       - 如果存在 init() 函数的话，则对该函数进行定义（这是一个特殊的函数，每个含有该函数的包都会首先执行这个函数）。
       - 如果当前包是 main 包，则定义 main() 函数。
       - 然后定义其余的函数，首先是类型的方法，接着是按照 main() 函数中先后调用的顺序来定义相关函数，如果有很多函数，则可以按照字母顺序来进行排序。

       ```
        package main

        import (
          "fmt"
        )

        const c = "C"

        var v int = 5

        type T struct{}

        func init() { // initialization of package
        }

        func main() {
          var a int
          Func1()
          // ...
          fmt.Println(a)
        }

        func (t T) Method1() {
          //...
        }

        func Func1() { // exported function Func1
          //...
        }
       ```

    2. Go 程序的执行（程序启动）顺序如下：
       - 按顺序导入所有被 main 包引用的其它包，然后在每个包中执行如下流程：
       - 如果该包又导入了其它的包，则从第一步开始递归执行，但是每个包只会被导入一次。
       - 然后以相反的顺序在每个包中初始化常量和变量，如果该包含有 init() 函数的话，则调用该函数。
       - 在完成这一切之后，main 也执行同样的过程，最后调用 main() 函数开始执行程序。

6.  类型转换

    - 在必要以及可行的情况下，一个类型的值可以被转换成另一种类型的值。
    - Go 语言不存在隐式类型转换，因此所有的转换都必须显式说明，就像调用一个函数一样（类型在这里的作用可以看作是一种函数）。例：`valueOfTypeB = typeB(valueOfTypeA)`。
    - 当从一个取值范围较大的转换到取值范围较小的类型时（例如将 int32 转换为 int16 或将 float32 转换为 int），会发生精度丢失（截断）的情况。
    - 具有相同底层类型的变量之间可以相互转换：
      ```
        var a IZ = 5
        c := int(a)
        d := IZ(c)
      ```

7.  Go 命名规范

    - 干净、可读的代码和简洁性是 Go 追求的主要目标。
    - 通过 gofmt 来强制实现统一的代码风格。
    - Go 语言中对象的命名也应该是简洁且有意义的。
    - 名称不需要指出自己所属的包，因为在调用的时候会使用包名作为限定符。
    - 返回某个对象的函数或方法的名称一般都是使用名词，没有 Get... 之类的字符，如果是用于修改某个对象，则使用 SetName()。
    - 有必须要的话可以使用大小写混合的方式，如 MixedCaps() 或 mixedCaps()，而不是使用下划线来分割多个名称。
